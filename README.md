# Flood-Sumo-interoperability

##Script 1
## Flood Risk Zones Analysis

The goal of this project is to automate the integration of flood information in traffic simulation models (towards digital twin interoperability of the flood and transport network). 

### Instructions for download Height Above Nearest Drainage (Hand) data

Accessing the StoryMap: I started by visiting the ArcGIS StoryMap page, which provided detailed insights and resources on flood mapping using HAND data.

Setting Location: Navigate the interactive maps available on StoryMap to focus on the region of interest. By setting the location, one can view relevant data and ensure downloading the correct dataset for the specific area.

Link: https://storymaps.arcgis.com/stories/fcd5cba6104645349f59e504042bacd6

Downloading the Data: On the ASF DAAC Vertex platform, I entered my location details to search for and download HAND data in TIFF format. This data was used in my project for analyzing flood-prone areas.

Download link: https://asf-daac.maps.arcgis.com/apps/mapviewer/index.html?webmap=6b82a2e4ccd343d5ba73dc04d386e4ee

### Flood impact visualization
The primary script provides tools for analyzing road networks in Wilmington, North Carolina, with a focus on assessing flood risk based on elevation data. The components include:

+ Installation of Dependencies:
-- Installs necessary libraries including GDAL, rasterio, osmnx, mapclassify, folium, and matplotlib.
  
+ Loading and Plotting Road Network:
-- Loads the road network for Wilmington using OpenStreetMap data through the osmnx library.
-- Visualizes the network with nodes and edges.
-- Elevation and Flood Risk Analysis:

+ Adds elevation data to the road network nodes using the Copernicus Global 30-m DEM.
-- Classifies road segments based on node elevation into three categories:Flooded (below a threshold of 2 meters),
Prone (elevation between 2 and 12 meters), and
Safe (above 12 meters).
Color-codes nodes and road segments to easily visualize flood risk.
Extracts specific road segments based on u, v values and their associated osmids.

+ Plots the classified nodes over the road network.
-- Integrates TIFF elevation data as a background for enhanced visualization.
-- Provides an interactive map using folium to explore flood risk classifications in a web-based format.
-- Exporting Results:

+ Saves the interactive map as an HTML file for easy sharing and exploration.

### Export flooded OSM ids in SUMO
The second set of scripts export the flooded OSM ids as CSVs, which are then read into SUMO traffic simulator for modeling appropriate lane closures.


## Script 2
## SUMO Simulation with Flooded Lanes


The Python script is designed to simulate vehicle rerouting in SUMO (Simulation of Urban MObility) by closing specific lanes based on flood risks. The script reads a CSV file containing OSM (OpenStreetMap) IDs of road segments that are at risk of flooding, closes those lanes during the simulation, and reroutes vehicles to available adjacent lanes.

### Features:
Dynamic Lane Closure: Lanes corresponding to flooded OSM IDs are closed after a specified number of steps.
Vehicle Rerouting: Vehicles on closed lanes are rerouted to adjacent lanes (if available).
Trip Information Parsing: Trip data before and after lane closures is collected and saved into CSV files for further analysis.
Error Handling: The script checks for the presence of necessary files (SUMO configuration and CSV) and handles potential errors gracefully.

### Usage:
Ensure that the SUMO_HOME environment variable is set correctly.
Modify the script to specify the correct path to your SUMO configuration file and the CSV file containing the OSM IDs of flooded lanes.
Run the script either in GUI mode or in command-line mode using the --nogui option.
### Requirements:
SUMO: The script interacts with SUMO through TraCI (Traffic Control Interface). Ensure SUMO is installed and properly configured.
CSV Data: A CSV file containing OSM IDs is required to specify which lanes should be closed during the simulation.
Python Libraries: The script uses pandas for data processing, and optparse, sumolib, traci for SUMO interaction.

### How It Works:
The simulation starts with normal traffic flow.
After a specified number of steps (e.g., 1000), lanes corresponding to OSM IDs in the CSV file are closed.
Vehicles on closed lanes are rerouted to adjacent lanes where possible.
Trip data before and after lane closure is collected and saved for analysis.

### Output:
tripinfo_before_closure.csv: Contains trip information before lanes are closed.
tripinfo_after_closure.csv: Contains trip information after the lanes are closed.
tripinfo.xml: Raw trip data generated by SUMO.
vehStatistic.xml: Detailed vehicle statistics generated by SUMO.





